-- USERS
CREATE TABLE USERS (
    USER_ID NUMBER PRIMARY KEY,
    USER_LOGIN_ID VARCHAR2(50) UNIQUE NOT NULL,
    USER_PASSWORD VARCHAR2(200) NOT NULL,           
    EMAIL VARCHAR2(100) UNIQUE NOT NULL,
    CREATED_AT DATE DEFAULT SYSDATE,
    ACCESS_KEY VARCHAR2(300),
    LAST_WORK DATE DEFAULT SYSDATE
);
CREATE SEQUENCE SEQ_USER_ID START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;

-- FOLDERS
CREATE TABLE FOLDERS (
    FOLDER_ID NUMBER PRIMARY KEY,
    USER_ID NUMBER NOT NULL,
    FOLDER_NAME VARCHAR2(200),
    CATEGORY_LIST VARCHAR2(500),
    CONNECTED_DIRECTORY VARCHAR2(300),
    CATEGORY_CHANGE VARCHAR2(300),
    LAST_WORK DATE DEFAULT SYSDATE
);
CREATE SEQUENCE SEQ_FOLDER_ID START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;

-- FILES
CREATE TABLE FILES (
    FILE_ID NUMBER PRIMARY KEY,
    USER_ID NUMBER NOT NULL,
    FOLDER_ID NUMBER,
    FILE_NAME VARCHAR2(200) NOT NULL,
    FILE_TYPE VARCHAR2(50),
    FILE_PATH VARCHAR2(300),
    IS_TRANSFORM NUMBER(1) DEFAULT 0,
    TRANSFORM_TXT_PATH VARCHAR2(300),
    IS_CLASSIFICATION NUMBER(1) DEFAULT 0,
    CATEGORY VARCHAR2(200),
    UPLOADED_AT DATE DEFAULT SYSDATE
);
CREATE SEQUENCE SEQ_FILE_ID START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;

-- LOGS
CREATE TABLE LOGS (
    LOG_ID NUMBER PRIMARY KEY,
    USER_ID NUMBER NOT NULL,
    LOG_TIME DATE DEFAULT SYSDATE,
    LOG_CONTENT VARCHAR2(1000)
);
CREATE SEQUENCE SEQ_LOG_ID START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;

------------------------------------------------------------------------------
--FK 설정--

-- FILES → USERS
ALTER TABLE FILES
ADD CONSTRAINT FK_FILES_USER
FOREIGN KEY (USER_ID)
REFERENCES USERS(USER_ID);

-- FILES → FOLDERS
ALTER TABLE FILES
ADD CONSTRAINT FK_FILES_FOLDER
FOREIGN KEY (FOLDER_ID)
REFERENCES FOLDERS(FOLDER_ID);

-- FOLDERS → USERS
ALTER TABLE FOLDERS
ADD CONSTRAINT FK_FOLDERS_USER
FOREIGN KEY (USER_ID)
REFERENCES USERS(USER_ID);

-- LOGS → USERS
ALTER TABLE LOGS
ADD CONSTRAINT FK_LOGS_USER
FOREIGN KEY (USER_ID)
REFERENCES USERS(USER_ID);

COMMIT;
